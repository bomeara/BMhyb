<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimize model — BMhyb • BMhyb</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Optimize model — BMhyb" />

<meta property="og:description" content="Fits a BMhyb model to your data." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BMhyb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/BMhyb">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimize model</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/BMhyb/blob/master/R/bmhyb.r'><code>R/bmhyb.r</code></a></small>
    <div class="hidden name"><code>BMhyb.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits a BMhyb model to your data.</p>
    
    </div>

    <pre class="usage"><span class='fu'>BMhyb</span>(<span class='no'>phy.graph</span>, <span class='no'>traits</span>, <span class='kw'>free.parameter.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"sigma.sq"</span>, <span class='st'>"mu"</span>, <span class='st'>"SE"</span>,
  <span class='st'>"bt"</span>, <span class='st'>"vh"</span>), <span class='kw'>confidence.points</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>measurement.error</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>do.Higham.correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>do.Brissette.correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>likelihood.precision</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>max.steps</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>confidence.lnl</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>reltol</span> <span class='kw'>=</span> <span class='fl'>0.001</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>phy.graph</th>
      <td><p>An ape::evonet object (a phylogeny stored in phylo format that also includes a reticulation matrix)</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>A vector of trait values, with names equal to the names of taxa on the phylogeny</p></td>
    </tr>
    <tr>
      <th>free.parameter.names</th>
      <td><p>What parameters you want to optimize rather than use defaults; options are sigma.sq, mu, SE, bt, and vh</p></td>
    </tr>
    <tr>
      <th>confidence.points</th>
      <td><p>How many points to use to estimate parameter uncertainty</p></td>
    </tr>
    <tr>
      <th>measurement.error</th>
      <td><p>How much uncertainty there is in tip values; a single number is applied to all taxa, a vector is applied to the corresponding taxa</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>In a hybridization event, what proportion of the trait comes from the donating parent. 0.5 means half comes from each parent</p></td>
    </tr>
    <tr>
      <th>do.Higham.correction</th>
      <td><p>Variance-covariance matrices for this model are sometimes poorly conditioned; this is a hack to reduce the impact of that</p></td>
    </tr>
    <tr>
      <th>do.Brissette.correction</th>
      <td><p>Applies method of Brissette et al. 2007 to also try to fix matrix condition</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If TRUE, BMhyb will chat about its progress</p></td>
    </tr>
    <tr>
      <th>likelihood.precision</th>
      <td><p>When optimizing, how much of a lnL improvement is required to restart optimization between starts</p></td>
    </tr>
    <tr>
      <th>max.steps</th>
      <td><p>The number of restarts without improvement it will attempt</p></td>
    </tr>
    <tr>
      <th>confidence.lnl</th>
      <td><p>For figuring out the confidence interval, how wide you want the confidence region to be in lnL space</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>List of options to pass to optim. ?optim for help.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class BMhybResult which contains best (a data.frame of the solution), good.region (data.frame of the points making up those in the confidence.lnl region), bad.region (all the other points sampled), phy.graph (same as what you put in), traits (same as what you put in), and free.parameter.names.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This takes an ape::evonet object. If all you have is a tree (an ape::phylo object), you can use CreateHybridlessEvonet() to convert the tree to an evonet object. You can then use the AddHybridization() function to add hybrid events to this object. Note that networks created in this way can, by chance, result in orders of nodes in the internal edge matrix that cause ape's reorder.phylo function to crash, which is called in many of the plot and write functions. You can still use the plot functions in this package, however.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='kw pkg'>utils</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"cichlid"</span>)
<span class='no'>result</span> <span class='kw'>&lt;-</span> <span class='fu'>BMhyb</span>(<span class='kw'>phy.graph</span><span class='kw'>=</span><span class='no'>cichlid</span>$<span class='no'>phy.graph</span>, <span class='kw'>traits</span><span class='kw'>=</span><span class='no'>cichlid</span>$<span class='no'>trait</span>,
  <span class='kw'>free.parameter.names</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"sigma.sq"</span>, <span class='st'>"mu"</span>))
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Dwueng-Chwuan Jhwueng, Brian C. O'Meara.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

